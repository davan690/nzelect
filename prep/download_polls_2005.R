url <- "https://en.wikipedia.org/wiki/Opinion_polling_for_the_New_Zealand_general_election,_2005"

webpage <- url %>%
    read_html(encoding = "UTF-8") 

tabs <- webpage %>%
    html_nodes("table") 

tab <- html_table(tabs[[1]], fill = TRUE) 

#View(tab)

tab <- tab[tab[ , 1] != tab[ , 2], ]
tab <- tab[tab[ , 1] != "Poll", ]
names(tab)[2] <- "WikipediaDates"

tab$WikipediaDates

tab$StartDate <- as.Date(c("27/7/2002", "1/9/2002", "16/9/2002",
                           "19/9/2002", "23/9/2002", "27/10/2002",
                           "18/10/2002", "18/11/2002", "18/11/2002",
                           "15/12/2002", "3/2/2003", "10/2/2003",
                           "17/2/2003", "23/3/2003", "7/4/2003",
                           "13/4/2003", "15/5/2003", "12/5/2003",
                           "9/6/2003", "16/6/2003", "1/7/2003",
                           "13/7/2003", "12/8/2003", "12/8/2003",
                           "17/8/2003", "15/9/2003", "15/10/2003",
                           "6/10/2003", "14/10/2003", "9/11/2003",
                           "14/12/2003", "23/2/2004", "5/2/2004",
                           "29/1/2004", "27/2/2004", "22/3/2004",
                           "25/3/2004", "25/4/2004", "17/5/2004",
                           "27/5/2004", "27/5/2004", "21/6/2004",
                           "5/7/2004", "31/7/2004", "1/8/2004",
                           "9/8/2004", "13/9/2004", "28/9/2004",
                           "30/9/2004", "14/10/2004", "15/11/2004",
                           "19/11/2004", "25/11/2004", "13/12/2004",
                           "1/2/2005", "4/2/2005", "14/2/2005",
                           "14/3/2005", "22/3/2005", "15/4/2005",
                           "17/4/2005", "16/5/2005", "9/6/2005",
                           "18/6/2005", "19/6/2005", "18/7/2005",
                           "21/7/2005", "21/7/2005", "1/8/2005",
                           "2/8/2005", "15/8/2005", "22/8/2005",
                           "25/8/2005", "29/8/2005", "3/9/2005",
                           "5/9/2005", "8/9/2005", "9/9/2005",
                           "12/9/2005", "13/9/2005", "17/9/2005"),
                         format = "%d/%m/%Y")

tab$EndDate <- as.Date(c("27/7/2002", "1/9/2002", "22/9/2002",
                         "22/9/2002", "26/9/2002", "27/10/2002",
                         "20/10/2002", "24/11/2002", "18/11/2002",
                         "15/12/2002", "3/2/2003", "16/2/2003",
                         "17/2/2003", "23/3/2003", "13/4/2003",
                         "13/4/2003", "18/5/2003", "15/5/2003",
                         "16/6/2003", "16/6/2003", "31/7/2003",
                         "13/7/2003", "17/8/2003", "12/8/2003",
                         "17/8/2003", "15/9/2003", "15/10/2003",
                         "6/10/2003", "14/10/2003", "9/11/2003",
                         "14/12/2003", "23/2/2004", "5/2/2004",
                         "4/2/2004", "29/2/2004", "22/3/2004",
                         "31/3/2004", "25/4/2004", "20/5/2004",
                         "1/6/2004", "3/6/2004", "21/6/2004",
                         "8/7/2004", "31/7/2004", "1/8/2004",
                         "12/8/2004", "13/9/2004", "28/9/2004",
                         "6/10/2004", "14/10/2004", "15/11/2004",
                         "27/11/2004", "1/12/2004", "13/12/2004",
                         "1/2/2005", "4/2/2005", "14/2/2005",
                         "17/3/2005", "30/3/2005", "15/4/2005",
                         "17/4/2005", "16/5/2005", "16/6/2005",
                         "18/6/2005", "19/6/2005", "18/7/2005",
                         "27/7/2005", "1/8/2005", "4/8/2005",
                         "15/8/2005", "18/8/2005", "25/8/2005",
                         "30/8/2005", "1/9/2005", "13/9/2005",
                         "8/9/2005", "14/9/2005", "14/9/2005",
                         "14/9/2005", "13/9/2005", "17/9/2005"), 
                       format = "%d/%m/%Y")

polls2005 <- tab[, !is.na(names(tab))]
